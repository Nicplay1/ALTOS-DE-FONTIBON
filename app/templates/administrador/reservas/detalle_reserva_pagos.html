{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Detalle Reserva</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <h2>Detalle Reserva #{{ reserva.id_reserva }}</h2>

    <form method="POST">
        {% csrf_token %}

        <h4>Informaci√≥n de la Reserva</h4>
        <ul class="list-group mb-3">
            <li class="list-group-item"><strong>Usuario:</strong> {{ reserva.cod_usuario.nombres }} {{ reserva.cod_usuario.apellidos }}</li>
            <li class="list-group-item"><strong>Zona:</strong> {{ reserva.cod_zona.nombre_zona }}</li>
            <li class="list-group-item"><strong>Fecha de reserva:</strong> {{ reserva.fecha_reserva }}</li>
            <li class="list-group-item"><strong>Fecha de uso:</strong> {{ reserva.fecha_uso }}</li>
            <li class="list-group-item"><strong>Hora inicio:</strong> {{ reserva.hora_inicio }}</li>
            <li class="list-group-item"><strong>Hora fin:</strong> {{ reserva.hora_fin }}</li>
            <li class="list-group-item"><strong>Forma de pago:</strong> {{ reserva.forma_pago }}</li>
            <li class="list-group-item"><strong>Valor:</strong> ${{ reserva.valor_pago }}</li>
        </ul>

        <div class="mb-3">
            {{ reserva_form.observacion.label_tag }}
            {{ reserva_form.observacion }}
        </div>
        <div class="mb-3">
            {{ reserva_form.estado.label_tag }}
            {{ reserva_form.estado }}
        </div>

        <h4>Pagos</h4>
        {% for pago in pagos %}
            <div class="mb-2 p-2 border rounded">
                <p><strong>Pago #{{ pago.id_pago }}</strong> - Subido: {{ pago.fecha_subida }}</p>
                <p>Archivos: 
                    <a href="{{ pago.archivo_1.url }}" target="_blank">Archivo 1</a>
                    {% if pago.archivo_2 %} | <a href="{{ pago.archivo_2.url }}" target="_blank">Archivo 2</a>{% endif %}
                </p>
                <div class="mb-3">
                    <label for="pagos_{{ pago.id_pago }}"><strong>Estado del pago</strong></label>
                    <select name="pagos_{{ pago.id_pago }}" id="pagos_{{ pago.id_pago }}" class="form-select">
                        <option value="En espera" {% if pago.estado == 'En espera' %}selected{% endif %}>En espera</option>
                        <option value="Aprobado" {% if pago.estado == 'Aprobado' %}selected{% endif %}>Aprobado</option>
                        <option value="Rechazado" {% if pago.estado == 'Rechazado' %}selected{% endif %}>Rechazado</option>
                    </select>
                </div>
            </div>
        {% empty %}
            <p>No hay pagos asociados.</p>
        {% endfor %}

        <button type="submit" class="btn btn-primary mt-3">Guardar Cambios</button>
    </form>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
